import { asyncTryCatch } from "../utils/asyncTryCatch.js";
import { sendErrorResponse } from "../utils/sendError.js";
import { parseCsvFile } from "../helpers/vulnerability.helper.js";
import vulnerabilityService from "../services/vulnerability.service.js";

const  vulnerabilityController = {};

vulnerabilityController.parseCsvVulnerability = asyncTryCatch(async (req, res)=>{
    if (!req.file) {
        return res.status(400).send(sendErrorResponse(400, "No Csv file uploaded"));
    }
    const data = await parseCsvFile(req.file);
    return res.status(data.status).send(data);

});

vulnerabilityController.addLinuxVulnerability = asyncTryCatch(async (req, res)=>{
    const data = req.body;
    const result = await vulnerabilityService.addLinuxVulnerability(data);
    return res.status(result.status).send(result);
});

export default vulnerabilityController;