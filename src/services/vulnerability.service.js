import { sendSuccessResponse } from "../utils/sendSuccess.js";
import { validateVulnerabilityList } from "../validations/vulnerability.validation.js";
import { formatZodErrorsArray } from "../utils/formatZodError.js";
import { sendErrorResponse } from "../utils/sendError.js";

const vulnerabilityService = {};

vulnerabilityService.addVulnerability = async (data)    => {
    const validatedData = validateVulnerabilityList.safeParse(data);
    if (!validatedData.success) {
        return sendErrorResponse(400, formatZodErrorsArray(validatedData.error));
    }
    const vulnerabilities = validatedData.data;
    return sendSuccessResponse(200, 'Vulnerability added successfully', vulnerabilities);
}

export default vulnerabilityService;